\chapter{Fallbeispiel}
In diesem Kapitel werden die Erkenntnisse aus den beiden vorangehenden Kapiteln genutzt um das Poisson Problem $\Delta u = 1, u|_{\p \Omega} = 0$ auf einem L-förmigen Gebiet   
\[
\Omega = [0,1]^2 \cap \left\{ r(\cos\phi,\sin\phi)| r\in\R,0<\phi<\frac{3 \pi}{2} \right\}
\] 
zu approximieren. Es wird also das Lösen-Approximieren-Markieren-Verfeinern Verfahren angewendet auf eine Anfangstriangulierung $\mathscr{T}_0$, zusehen in Abbildung \ref{grid}, um eine Folge von Triangulierungen und Approximationen auf diesen Triangulierungen zu erhalten. Als Verfeinerungsverfahren wird das Rot-Grün-Blau Verfahren genutzt.

\begin{figure}[!htbp]
	\begin{center}
		\includegraphics[width=13cm]{pics/nonref.png}
	\end{center}
	\caption{\label{grid}Triangulierung eines L-förmigen Gebiets (links) Approximierung einer Lösung des Poissonproblems (rechts)}
\end{figure}

\section{Implementation}
Im Folgenden ist eine Implementation des Lösen-Approximieren-Markieren-Verfeinern Verfahrens in \matlab \: zu finden. In Abbildung \ref{main} ist das Hauptprogramm zu sehen. Die Matrix c4n, coordinates for nodes, enthält in der i-ten Zeile die x und y Koordinate des i-ten Knotens im Gitter. Die Matrix n4e, nodes for elements, enthält in der i-ten Zeile die Nummer der Knoten, die zu dem i-ten Element gehören. Dabei ist die Kante vom ersten zum dritten Knoten die längste. Diese Konvention wird für das Rot-Grün-Blau Verfahren benötigt. Db, Dirichlet bondary, gibt in diesem Fall den Rand des Gebiets vor da der Neumann Rand leer ist. In jeder Zeile stehen die Nummern der Knoten die zu einer Kante auf dem Rand gehören. \\
Das Unterprogramm $\texttt{comp\_estimators}$, zu sehen in Abbildung \ref{indi}, berechnet die Verfeinerungsindikatoren
\[
\eta^2_T(u_k) = h^2_T\|f\|^2_{L^2(T)} + \sum_{S\subset\p T} h_S\|\llbracket \nabla u_k \cdot n_S\rrbracket\|^2_{L^2(S)} 
\]
unter Benutzung der Abschätzung $h_T^{d-2}|S| \leq ch_S$.
Als Menge der zu verfeinernden Elemente wird vereinfachend
\[
M_k = \{T\in\mathscr{T}_k | \eta_T(u_k)\geq \Theta \max_{T'\in \mathscr{T}_k} \eta_{T'}(u_k)\}
\]
benutzt. $M_k$ ist damit in jedem Fall nichtleer, außer $u_k$ ist bereits die exakte Lösung. \\
Das Unterprogramm $\texttt{sides}$, in Abbildung \ref{indi} unten, liefert eine Datenstruktur für $\mathscr{S}_k$ die in $\texttt{comp\_estimators}$ verwendet wird. In n4s, nodes for sides, befindet sich in der i-ten Zeile die Knoten der i-ten Seite. Diese Nummerierung der Seiten wird benutzt um in s4e, sides for elements, jedem Dreieck seine Seiten zuzuordnen, und in e4s, elements for sides, jeder Seite die zwei anliegenden Elemente oder wenn die Seite auf dem Rand liegt das eine anliegende Element zu zuweisen.

\begin{figure}[!htbp]
	\lstinputlisting{codes/p1_adaptive.m}
	\caption{ \label{main}Hauptprogramm des Lösen-Approximieren-Markieren-Verfeinern Verfahrens (oben) Konstruktion der Finite Elemente Verfahrensmatrix (unten)}
\end{figure}
\begin{figure}[!htbp]
	\lstinputlisting{codes/p1_adaptive3.m}
	\caption{\label{indi}Berechnung der Verfeinerungsindikatoren}
\end{figure}

\begin{figure}[!htbp]
	\lstinputlisting{codes/p1_adaptive2.m}
	\caption{\label{redref} \matlab-Implementation der Rot-Grün-Blau Verfeinerung}
\end{figure}
\newpage \newpage \newpage  
\section{Vergleich von Gitterfolgen}
Mit dem vorgestellten \matlab \:Programm angewendet auf die Anfangstriangulierung $\mathscr{T}_0$, die durch die Mittgabe des Parameters \texttt{red=2} erzeugt wurde(Abbildung \ref{grid}), erhält man eine Gitterfolge. Verwendet man verschieden $\Theta$, so werden verschiedene Elemente markiert und man erhält unterschiedliche Gitterfolgen. In der Tabelle \ref{tabelle} sind Triangulierungsfolgen von $\Theta =0,2/0,4/0,5/0,6 \text{ und } 0,8$ zusehen. Man kann beobachten, dass für $\Theta = 0,2$ fast alle, während für $\Theta = 0,8$ nur ein einziges Element im ersten Schritt markiert wurden. Man kann bei allen Folgen eine starke Dichte an Elementen in den Ecken, besonders der einspringenden Ecke erkennen.\\
\begin{table}[!htbp]
	\begin{tabular}{c}
		\includegraphics[width=15.5cm]{pics/grid02.png} \\
		\includegraphics[width=15.5cm]{pics/grid04.png} \\
		\includegraphics[width=15.5cm]{pics/grid05.png} \\
		\includegraphics[width=15.5cm]{pics/grid06.png} \\
		\includegraphics[width=15.5cm]{pics/grid08.png} \\
	\end{tabular}
	\caption{ \label{tabelle} Gitterfolgen für verschiedene Theta. Von oben nach unten: $\Theta = 0,2/0,4/0,5/0,6/0,8$}
\end{table}
\begin{table}[!htbp]
	\begin{tabular}{r|c|c|c}
		$\Theta\setminus\varepsilon_{stop}$& $2\cdot10^{-1}$ & $1\cdot10^{-1}$&$5\cdot10^{-2}$ \\
		\hline
		0,2&7,3s, 988Kn, 5 Schritte&55,2s, 4114 Kn, 8 Schritte&4min, 16356 Kn, 11 Schritte\\	
		0,4&11,4s 1478Kn, 7 Schritte&46,7s, 3730 Kn, 9 Schritten&4min20s, 14567 Kn, 12 Schritte\\
		0,5&9,4s, 1105Kn, 7 Schritte&62,5s, 4269Kn, 10 Schritte&5min40s, 16668Kn, 13 Schritte\\
		0,6&13,5s, 971Kn, 7 Schritte&71,1s, 3954Kn, 10 Schritte&\\
		0,8&&&\\
	\end{tabular}
	\caption{Werte aus Messreihe mit verschiedenen Parametern für $\Theta$ und die Abbruchbedingung $\varepsilon_{stop}$ die den Fehler der letzten Approximation beschränkt. Es wird die Zeit angegeben die das ganze verfahren benötigt hat, sowie die Anzahl der Knotenpunkte (Kn) in der letzten Triangulierung}
\end{table}
